"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),a=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,n=require("@crystallize/react-image"),i=!1,r=!1;exports.Video=function(e){var o=e.playlists,l=e.thumbnails,c=e.thumbnailProps,s=e.videoProps,d=e.autoPlay,u=e.loop,v=void 0!==u&&u,f=e.muted,m=void 0!==f&&f,p=e.controls,h=void 0===p||p,w=e.poster,y=e.playButtonText,b=void 0===y?"Play video":y,E=e.className,g=t.useState(!0),_=g[0],j=g[1],P=t.useState(!1),S=P[0],M=P[1],N=t.useState(!1),x=N[0],z=N[1],L=t.useRef(null);t.useEffect((function(){if(d){var e=navigator.connection;e&&e.saveData||M(!0)}}),[]),t.useEffect((function(){if(S&&!x){var e=L.current;if(!e)throw new Error("Cannot initialize video. Unable to find the video HTML node");e.addEventListener("playing",(function(){return j(!1)}),{once:!0});var t=function(){try{var e=navigator.connection;return e.downlink>=5&&!e.saveData}catch(e){return!1}}(),a=o.find((function(e){return e.endsWith(".m3u8")}));a?e.canPlayType("application/vnd.apple.mpegurl")?(e.autoplay=!0,e.src=a,z(!0)):new Promise((function(e){if(!r){var t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/hls.js@latest",t.defer=!0,document.head.appendChild(t),r=!0}!function t(){"Hls"in window?e(new window.Hls({testBandwidth:!1,abrEwmaDefaultEstimate:1e6,abrMaxWithRealBitrate:!0})):setTimeout(t,10)}()})).then((function(t){t.loadSource(a),t.attachMedia(e),t.on("hlsMediaAttached",(function(){e.muted=!0,e.play()})),z(!0)})):(n="WebKitMediaSource"in window,l="MediaSource"in window,(n||l)&&new Promise((function(e){if(!i){var t=document.createElement("script");t.src="https://cdn.dashjs.org/latest/dash.all.min.js",t.defer=!0,document.head.appendChild(t),i=!0}!function t(){"dashjs"in window?e(window.dashjs):setTimeout(t,10)}()})).then((function(a){var n=o.find((function(e){return e.endsWith(".mpd")}));if(!n)throw new Error("Cannot find a valid Dash source for video");var i=a.MediaPlayer().create();i.initialize(),i.updateSettings({debug:{logLevel:a.Debug.LOG_LEVEL_NONE},streaming:{abr:{initialBitrate:{audio:-1,video:t?1e4:-1},autoSwitchBitrate:{audio:!0,video:!0}}}}),i.setAutoPlay(!0),i.attachView(e),i.attachSource(n),z(!0)})))}var n,l}),[S]);var B={zIndex:_?2:1,opacity:_?1:0},D=w||function(e){if(e&&e.length>0){var t=e[0];if(t._availableSizes&&t._availableFormats)return t.url;var a=t.variants.filter((function(e){return!e.url.endsWith(".webp")&&!e.url.endsWith(".avif")}));return a.filter((function(e){return e.width>500})).sort((function(e,t){return e.width-t.width}))[0].url||a[0].url}}(l);return a.createElement("div",{className:"react-video"+(E?" "+E:""),style:{position:"relative"}},l&&l.length>0?a.createElement(n.Image,Object.assign({},l[0],{className:"react-video__thumbnail"},c,{style:B})):a.createElement("div",{className:"react-video__thumbnail-placeholder",style:B}),!S&&a.createElement("button",{className:"react-video__play-btn",onClick:function(e){e.preventDefault(),M(!0)}},b,a.createElement("svg",{viewBox:"0 0 100 100",className:"react-video__play-icon"},a.createElement("path",{d:"M78.158 51.843L25.842 82.048c-1.418.819-3.191-.205-3.191-1.843v-60.41c0-1.638 1.773-2.661 3.191-1.843l52.317 30.205c1.418.819 1.418 2.867-.001 3.686z"}))),a.createElement("video",Object.assign({className:"react-video__video",ref:L,controls:h,playsInline:!0,muted:m,loop:v,poster:D,style:{opacity:x?1:0,zIndex:_?1:2}},s)))};
//# sourceMappingURL=react-video.cjs.production.min.js.map
